;---------------------------------------------------
; Programa: CONTA VETOR
; Autor: GABRIEL AUREO
; Data: 05/09/2018
;---------------------------------------------------

ORG 100

VETOR: DW 21896, -9898, 0, 0, 6, -255, 656, 0, 4873, -99
TAM: DB 10
VPNTR: DW VETOR
STRPOS: STR "POSITIVOS: "
DB 0
STRNEG: STR "NEGATIVOS: "
DB 0
STRZER: STR "ZEROS: "
DB 0

ORG 0

MAIN:

LDA VPNTR+1
PUSH
LDA VPNTR
PUSH
LDA TAM

JSR CONTA


HLT
END MAIN

ORG 5000
STRPTR: DW 0
SP1: DW 0
DIG: DB 0
VALOR: DB 0
CLEARB EQU 3
CONSOLE EQU 2
BANNER EQU 2

ORG 4000
IMPRIME:
STS SP1
STA VALOR
POP
POP
STA STRPTR
POP
STA STRPTR+1
OUT CLEARB

WRTSTR:
LDA @STRPTR
OR #0
JZ WRTVAL
OUT BANNER
LDA #CONSOLE
TRAP @STRPTR
LDA PTR
ADD #1
STA PTR
JMP LOOP
WRTVAL:
LDA VALOR
AND #15
STA DIG
OUT BANNER
LDA #CONSOLE
TRAP DIG
LDA VALOR
AND #240





LDS SP1



ORG 2000
T: DB 0
I: DB 1
PTR: DW 0
NUM: DW 0
POSITIVOS: DB 0
NEGATIVOS: DB 0
ZEROS: DB 0
SP: DW 0

ORG 1000
CONTA:
STS SP
ADD #1
STA T
POP
POP
POP
STA PTR
POP
STA PTR+1

ITERA:
LDA T
SUB I
JZ FIM

LDS @PTR
STS NUM

LDS PTR
POP
POP
STS PTR

LDA NUM+1
JN NEGATIVO
JNZ POSITIVO
LDA NUM
JZ ZERO
POSITIVO:
LDA POSITIVOS
ADD #1
STA POSITIVOS
JMP PROX

NEGATIVO:
LDA NEGATIVOS
ADD #1
STA NEGATIVOS
JMP PROX

ZERO:
LDA ZEROS
ADD #1
STA ZEROS
JMP PROX

PROX:
LDA I
ADD #1
STA I
JMP ITERA

FIM:
LDS SP
RET

